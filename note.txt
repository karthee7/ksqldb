CREATE STREAM USER_STREAM (userid VARCHAR, country VARCHAR)   WITH (KAFKA_TOPIC='USER',VALUE_FORMAT='JSON', PARTITIONS=1);


CREATE TABLE USER_TABLE_LIST_MAT AS SELECT userid,  COLLECT_LIST(country)  FROM  USER_STREAM GROUP BY userid;

CREATE TABLE USER_TABLE_LATEST_OFFSET_MAT AS SELECT userid,  LATEST_BY_OFFSET(country)  FROM  USER_STREAM GROUP BY userid;